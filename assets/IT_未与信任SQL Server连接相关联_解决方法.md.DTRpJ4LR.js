import{_ as e,o,c as t,a7 as r}from"./chunks/framework.CmR4KQfH.js";const i="/images/2005/07/28_12753.gif",v=JSON.parse('{"title":"[未与信任 SQL Server 连接相关联]解决方法","description":"","frontmatter":{"title":"[未与信任 SQL Server 连接相关联]解决方法","id":845,"categories":["IT"],"abbrlink":"9bdb9439","date":"2005-07-28T00:08:00.000Z","tags":null},"headers":[],"relativePath":"IT/未与信任SQL Server连接相关联_解决方法.md","filePath":"IT/未与信任SQL Server连接相关联_解决方法.md","lastUpdated":1719711816000}'),S={name:"IT/未与信任SQL Server连接相关联_解决方法.md"},_=r('<p>企业管理器可以正常登陆，可是ASP页面却出错，无论怎么改用户/密码、别名，都没用，出错信息如下</p><blockquote><p>Microsoft VBScript 编译器错误 错误 &#39;800a03f6&#39; 缺少 &#39;End&#39;</p><p>/iisHelp/common/500-100.asp，行242</p><p>Microsoft OLE DB Provider for ODBC Drivers 错误 &#39;80040e4d&#39;</p><p>[Microsoft][ODBC SQL Server Driver][SQL Server]用户 &#39;sa&#39; 登录失败。原因: 未与信任 SQL Server 连接相关联。</p><p>/conn.asp，行7</p></blockquote><p>该错误产生的原因是由于SQL Server使用了&quot;仅 Windows&quot;的身份验证方式，因此用户无法使用SQL Server的登录帐户（如 sa ）进行连接。解决方法如下所示：</p><ol><li>在服务器端使用企业管理器，并且选择&quot;使用 Windows 身份验证&quot;连接上 SQL Server；</li><li>展开&quot;SQL Server组&quot;，鼠标右键点击SQL Server服务器的名称，选择&quot;属性&quot;，再选择&quot;安全性&quot;选项卡；</li><li>在&quot;身份验证&quot;下，选择&quot;SQL Server和 Windows &quot;。</li><li>重新启动SQL Server服务。</li></ol><p><img src="'+i+'" alt="MSSQL"></p><p>在以上解决方法中，如果在第 1 步中使用&quot;使用 Windows 身份验证&quot;连接 SQL Server 失败，那么我们将遇到一个两难的境地：首先，服务器只允许了 Windows 的身份验证；其次，即使使用了 Windows 身份验证仍然无法连接上服务器。这种情形被形象地称之为&quot;自己把自己锁在了门外&quot;，因为无论用何种方式，用户均无法使用进行连接。实际上，我们可以通过修改一个注册表键值来将身份验证方式改为 SQL Server 和 Windows 混合验证，步骤如下所示：</p><ol><li>点击&quot;开始&quot;-&quot;运行&quot;，输入regedit，回车进入注册表编辑器；</li><li>依次展开注册表项，浏览到以下注册表键： <code>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\MSSQLServer\\MSSQLServer]</code></li><li>在屏幕右方找到名称&quot;LoginMode&quot;，双击编辑双字节值；</li><li>将原值从1改为2，点击&quot;确定&quot;；</li><li>关闭注册表编辑器</li></ol>',7),s=[_];function a(l,p,d,u,c,n){return o(),t("div",{"data-pagefind-body":!0},s)}const L=e(S,[["render",a]]);export{v as __pageData,L as default};
